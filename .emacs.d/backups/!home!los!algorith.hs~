{-# LANGUAGE OverloadedStrings, FlexibleInstances, TypeSynonymInstances #-}

{-|

This is where all the routes and handlers are defined for your site. The
'site' function combines everything together and is exported by this module.

-}


import           Control.Applicative
import           Control.Monad
import           Data.Maybe
import           Data.List
import           Data.ByteString.Internal
import qualified Data.Text.Encoding as T
import qualified Data.Text as DT
import           Debug.Trace
import           System.Random


class DieRoller a where
  rollDie :: a -> Int -> IO Int

--class RandomAlg a where
--  execute :: DieRoller x => a -> x -> IO Int

findExpected :: (DieRoller x) => (x -> Int) -> Int -> IO Double
findExpected = undefined

consecutiveHeads :: DieRoller x => x -> IO Int
consecutiveHeads roller = do
  coins <- sequence $ map (rollDie roller) (repeat 2)
  return $ length $ takeWhile (/=1) coins

type StdRandomGen = (StdGen->(Int,StdGen)) -> IO Int

instance DieRoller StdRandomGen  where
  rollDie gen sides = gen (randomR (1,sides))X

main = do
  let g = getStdRandom
  a <- rollDie g 6
  print a
